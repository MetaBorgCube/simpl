module simpl

imports
  Common

context-free start-symbols
  Exp

context-free syntax
  
  Exp.Lit   = <<INT>>
  Exp.Plus  = <<Exp> + <Exp>> {left}
  Exp.Minus = <<Exp> - <Exp>> {left}
  Exp.Times = <<Exp> * <Exp>> {left}

  Exp = <(<Exp>)> {bracket}
  
context-free syntax

  Exp.Let = <let <ID> = <Exp> in <Exp>> {non-assoc}
    
  Exp.Var = <<ID>> 

context-free syntax

  Exp.Box = <box(<Exp>)>
  Exp.Unbox = <unbox(<Exp>)>
  Exp.Setbox = <setbox(<Exp>, <Exp>)>

context-free syntax

  Exp.Fun = [[ID] -> [Exp]] {right}
  Exp.App = <<Exp>(<Exp>)> {left}

context-free priorities

  {left:
    Exp.App
  } >
  {left:
    Exp.Times
  } >
  {left:
    Exp.Plus
    Exp.Minus
  } >
  {right:
    Exp.Fun
  } >
  {non-assoc:
    Exp.Let
  }
  


